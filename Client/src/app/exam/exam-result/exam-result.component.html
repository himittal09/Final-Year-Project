<div class="container">
  <div class="bs-component">
    <div *ngIf="hasDataLoadingComplete">
      <div>
        <fieldset>
          <h1>Exam Result:</h1>
          <hr>
      
          <div class="table-responsive">
            <table class="table table-striped table-hover">
              <thead>
                <tr>
                  <th colspan="4" class="centre"><h3>Exam Detail</h3></th>
                </tr>
                <tr>
                  <th>Name</th>
                  <th>Description</th>
                  <th>Subject</th>
                  <th>Allowed Time</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>{{exam?.name}}</td>
                  <td>{{exam?.description}}</td>
                  <td>{{exam?.subject}}</td>
                  <td>{{exam?.allowedTime}}</td>
                </tr>
              </tbody>
            </table>
          </div>
      
          <div class="table-responsive">
            <table class="table table-striped table-hover">  
              <thead>
                <tr>
                  <th colspan="6" class="centre"><h3>Exam Submission Data</h3></th>
                </tr>
                <tr>
                  <th>Marks Obtained</th>
                  <th>Total Questions Attempted</th>
                  <th>Total Questions Not Attempted</th>
                  <th>Total Time Taken</th>
                  <th>Percentage Of Questions Attempted</th>
                  <th>Percentage Of Question Not Attempted</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>{{examReturn?.marksObtained}}</td>
                  <td>{{examReturn?.totalQuestionAttempted}}</td>
                  <td>{{examReturn?.totalQuestionNotAttempted}}</td>
                  <td>{{examReturn?.totalTimeTaken}}</td>
                  <td>{{examReturn?.percentageOfQuestionAttempted}} %</td>
                  <td>{{examReturn?.percentageOfQuestionNotAttempted}} %</td>
                </tr>
              </tbody>  
            </table>
          </div>
      
          <div class="table-responsive">
            <table class="table table-striped table-hover">  
              <thead>
                <tr>
                  <th colspan="6" class="centre"><h3>Exam Analysis Data</h3></th>
                </tr>
                <tr>
                  <th>Average Questions Attempted By Students</th>
                  <th>Average Time Spent By Students</th>
                  <th>Average marks Obtained By Students</th>
                  <th>Number of Students Attempted this Exam</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>{{examAnalysis?.averageQuestionsAttempted}}</td>
                  <td>{{examAnalysis?.averageTimeSpent}}</td>
                  <td>{{examAnalysis?.cutOff}}</td>
                  <td>{{examAnalysis?.studentsAttempted}}</td>
                </tr>
              </tbody>  
            </table>
          </div>
      
        </fieldset>
          
            <br>
            <div class="clearfix">
              <div class="row">
                <div class="col-xs-12">
                  <legend><h1>Questions Result:</h1></legend>
                </div>
              </div>
              <ul class="list-group centre">
                <a *ngFor="let question of questions; let i = index" class="btn btn-large btn-primary listButton" (click)="selectQuestionForDisplay(question._id, i+1)">{{i+1}}</a>
              </ul>
          
              <fieldset>
                <div class="row">
                  <div class="col-md-6">
                    <div class="table-responsive">
                      <table class="table table-striped table-hover">
                        <tbody>
                          <tr>
                            <th>ID: </th>
                            <td>{{selectedQuestion?._id}}</td>
                          </tr>
                          <tr>
                            <th>Question: </th>
                            <td>{{selectedQuestion?.body}}</td>
                          </tr>
                          <tr>
                            <th>Answer Option One: </th>
                            <td>{{selectedQuestion?.answerOptionOne}}</td>
                          </tr>
                          <tr>
                            <th>Answer Option Two: </th>
                            <td>{{selectedQuestion?.answerOptionTwo}}</td>
                          </tr>
                          <tr>
                            <th>Answer Option Three: </th>
                            <td>{{selectedQuestion?.answerOptionThree}}</td>
                          </tr>
                          <tr>
                            <th>Answer Option Four: </th>
                            <td>{{selectedQuestion?.answerOptionFour}}</td>
                          </tr>
                          <tr>
                            <th>Corrrect Answer: </th>
                            <td>{{selectedQuestion?.correctAnswer}}</td>
                          </tr>
                          <tr>
                            <th>Marks: </th>
                            <td>{{selectedQuestion?.marksForCorrectAnswer}}</td>
                          </tr>
                          <tr>
                            <th>Negative Marks: </th>
                            <td>{{selectedQuestion?.negativeMark}}</td>
                          </tr>
                          <tr>
                            <th>Difficulty: </th>
                            <td>{{selectedQuestion?.difficulty}}</td>
                          </tr>
                        </tbody>
                      </table>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="table-responsive">
                      <table class="table table-striped table-hover">
                        <tbody>
                          <tr>
                            <th>Time taken: </th>
                            <td>{{selectedQuestion?.timeTaken}}</td>
                          </tr>
                          <tr>
                            <th>Answer Submitted: </th>
                            <td>{{selectedQuestion?.answerSubmitted}}</td>
                          </tr>
                          <tr>
                            <th>Is Answer Correct: </th>
                            <td>{{selectedQuestion?.isAnswerCorrect}}</td>
                          </tr>
                          <tr>
                            <th>Marks Obtained</th>
                            <td>{{selectedQuestion?.marksObtained}}</td>
                          </tr>
                        </tbody>
                      </table>
                    </div>
                  </div>
                </div>
              </fieldset>
            </div>
      </div>
      <div>
        <div class="row">
          <div class="col-xs-12">
            <hr>
            <h2>Graphs: </h2>
          </div>
          <div class="col-md-6 col-md-offset-3 col-sm-8 col-sm-offset-2 col-xs-12 centre">
            
            <ngx-charts-bar-horizontal-normalized
              [results]="percentWhoAttemptedDataSet?.graphData"
              [scheme]="percentWhoAttemptedDataSet?.graphColorScheme"
              [schemeType]="'ordinal'"
              [animations]="true"
              [legend]="true"
              [legendTitle]="'Legend'"
              [showXAxisLabel]="true"
              [showYAxisLabel]="true"
              [xAxis]="true"
              [yAxis]="true"
              [showGridLines]="false"
              [roundDomains]="true"
              [xAxisLabel]="'Percentage of Students'"
              [yAxisLabel]="'Questions'"
              [gradient]="false"
              [view]="percentWhoAttemptedDataSet?.graphSize"
              [barPadding]="8"
              [tooltipDisabled]="false">
            </ngx-charts-bar-horizontal-normalized>
            <h3 class="centre">Students Attemps for Questions</h3>
            <br>
            <br>

            <ngx-charts-bar-horizontal-normalized
              [results]="percentWhoGotRight?.graphData"
              [scheme]="percentWhoGotRight?.graphColorScheme"
              [schemeType]="'ordinal'"
              [animations]="true"
              [legend]="true"
              [legendTitle]="'Legend'"
              [showXAxisLabel]="true"
              [showYAxisLabel]="true"
              [xAxis]="true"
              [yAxis]="true"
              [showGridLines]="false"
              [roundDomains]="true"
              [xAxisLabel]="'Percentage of Students'"
              [yAxisLabel]="'Questions'"
              [gradient]="false"
              [view]="percentWhoGotRight?.graphSize"
              [barPadding]="8"
              [tooltipDisabled]="false">
            </ngx-charts-bar-horizontal-normalized>
            <h3 class="centre">Students Accuracy for Questions</h3>
            <br>
            <br>

          </div>
          <div class="col-xs-12">
            <ngx-charts-number-card
              [view]="studentsAttempted?.graphSize"
              [scheme]="studentsAttempted?.graphColorScheme"
              [results]="studentsAttempted?.graphData"
              [animations]="true"
              [cardColor]="'#d1cfcf'">
            </ngx-charts-number-card>
            <div class="col-xs-12">
              <h3 class="centre">Number of Attemps for each question</h3>
            </div>
            <br>
            <br>

          </div>
          <div class="col-md-6 col-md-offset-3 col-sm-8 col-sm-offset-2 col-xs-12 centre">
            <ngx-charts-line-chart
              [view]="marksComparison?.graphSize"
              [scheme]="marksComparison?.graphColorScheme"
              [results]="marksComparison?.graphData"
              [schemeType]="'ordinal'"
              [animations]="true"
              [legend]="true"
              [legendTitle]="'Legend'"
              [xAxis]="true"
              [yAxis]="true"
              [showGridLines]="false"
              [roundDomains]="true"
              [showXAxisLabel]="true"
              [showYAxisLabel]="true"
              xAxisLabel="xAxisLabel"
              yAxisLabel="yAxisLabel"
              [autoScale]="false"
              [gradient]="false"
              [tooltipDisabled]="false">
            </ngx-charts-line-chart>
            <h3>Comparison of Marks</h3>
            <br>
            <br>

            <ngx-charts-area-chart
              [view]="timeComparison?.graphSize"
              [scheme]="timeComparison?.graphColorScheme"
              [results]="timeComparison?.graphData"
              [schemeType]="'ordinal'"
              [animations]="true"
              [legend]="true"
              [legendTitle]="'Legend'"
              [xAxis]="true"
              [yAxis]="true"
              [showGridLines]="false"
              [showXAxisLabel]="true"
              [showYAxisLabel]="true"
              xAxisLabel="xAxisLabel"
              yAxisLabel="yAxisLabel"
              [autoScale]="false"
              [gradient]="false"
              [tooltipDisabled]="false">
            </ngx-charts-area-chart>
            <h3>Comparison of Time Taken</h3>
            <br>

          </div>
        </div>
      </div>
    </div>

    <div *ngIf="!hasDataLoadingComplete">
      Please Wait while the result is being calculated
    </div>
  </div>
</div>